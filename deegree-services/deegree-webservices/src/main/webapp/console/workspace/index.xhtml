<ui:composition template="/layout.xhtml" xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html"
  xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:p="http://primefaces.org/ui">
  <ui:define name="center">
    <p:outputPanel>
      <fieldset class="fieldset">
        <legend>
          <h:outputText styleClass="title" value="#{labels.workspace_title}" />
        </legend>

        <table style="font-size: small" border="0">
          <tr>
            <td style=""><h:outputText value="#{labels.workspace_dir}" /></td>
            <td />
            <td style=""><h:outputText value="#{workspace.workspaceRoot}" /></td>
          </tr>
        </table>

        <br /> <br />
        <h:outputText styleClass="title" value="Active workspace" />
        <table style="margin: 10px 0px; font-size: small" border="0">
          <h:form>
            <tr align="left">
              <td><h:outputText value="#{workspace.activeWorkspace.name}" /></td>
            </tr>
          </h:form>
        </table>
 
        <br /> <br />
        <h:outputText styleClass="title" value="Available workspaces" />
        <table style="margin: 10px 0px; font-size: small" border="0">
          <ui:repeat var="workspaceName" value="#{workspace.workspaceList}">
            <p:outputPanel rendered="#{workspace.activeWorkspace.name != workspaceName}">
              <h:form>
                <tr align="left">
                  <td><h:outputText value="#{workspaceName}" /></td>
                  <td><p:commandButton styleClass="ui-button buttonInfo" label="#{workspaceName}"
                      value="#{labels.start_workspace}" action="#{workspace.startWorkspace}" oncomplete="location.reload();" >
                      <f:setPropertyActionListener target="#{actionParams.param1}" value="#{workspaceName}" />
                    </p:commandButton></td>
                  <td><p:commandButton styleClass="ui-button buttonDelete" label="#{workspaceName}"
                      onclick="return confirmDelete();" value="#{labels.delete_workspace}"
                      action="#{workspace.deleteWorkspace}" global="false" oncomplete="location.reload();" >
                      <f:setPropertyActionListener target="#{actionParams.param1}" value="#{workspaceName}" />
                    </p:commandButton></td>
                </tr>
              </h:form>
            </p:outputPanel>
          </ui:repeat>
        </table>

        <br /> <br />
        <h:outputText styleClass="title" value="Import an official workspace" />
        <table style="margin: 10px 0px; font-size: small" border="0">
          <ui:repeat var="workspaceName" value="#{workspace.remoteWorkspaces}">
            <h:form>
              <tr align="left">
                <td><h:outputText value="#{workspaceName}" /></td>
                <td><p:commandButton styleClass="ui-button buttonEdit" label="#{workspaceName}" value="Import"
                     action="#{workspace.downloadWorkspace}" oncomplete="location.reload();" >
                    <f:setPropertyActionListener target="#{actionParams.param1}" value="#{workspaceName}" />
                  </p:commandButton></td>
              </tr>
            </h:form>
          </ui:repeat>
        </table>
        <p:outputPanel rendered="#{empty workspace.remoteWorkspaces}">
          <h:outputText styleClass="error" value="Unable to fetch list of workspaces. Are your proxy settings correct?" />
        </p:outputPanel>

        <br /> <br />
        <h:outputText styleClass="title" value="Create a new workspace" />
        <table style="margin: 10px 0px; font-size: small" border="0">
          <h:form>
            <tr>
              <td><p:outputLabel styleClass="label" for="newFSBt" value="Identifier" />
                <h:inputText styleClass="liste" id="newFSBt" value="#{createWorkspaceBean.workspaceName}" size="16" required="true"
                requiredMessage="#{labels.resource_name_req}" /></td>
            </tr>
            <tr>
              <td><p:commandButton styleClass="ui-button buttonCreateNew" value="#{labels.featureStores_new}"
                action="#{createWorkspaceBean.createWorkspaceFolder}" global="false" oncomplete="location.reload();" /></td>
            </tr>
          </h:form>
        </table>

        <br /> <br />
        <h:outputText styleClass="title" value="Upload workspace" />
        <h:form>
          <table style="margin: 10px 0px; font-size: small" border="0">
            <tr>
              <td><p:fileUpload listener="#{workspace.handleFileUpload}"
                                mode="advanced"
                                multiple="false"
                                skinSimple="true"
                                oncomplete="location.reload();"
                                allowTypes="/(\.|\/)(zip|gzip|tar.gz)$/"/></td>
            </tr>
<!--            <tr>-->
<!--              <td><p:commandButton styleClass="ui-button buttonInfo" value="Upload" ajax="false" update=":container" global="false"/></td>-->
<!--            </tr>-->
          </table>
        </h:form>
      </fieldset>
    </p:outputPanel>
  </ui:define>
</ui:composition>
