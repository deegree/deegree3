//$HeadURL$
/*----------------------------------------------------------------------------
 This file is part of deegree, http://deegree.org/
 Copyright (C) 2013 by:

 IDgis bv

 This library is free software; you can redistribute it and/or modify it under
 the terms of the GNU Lesser General Public License as published by the Free
 Software Foundation; either version 2.1 of the License, or (at your option)
 any later version.
 This library is distributed in the hope that it will be useful, but WITHOUT
 ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more
 details.
 You should have received a copy of the GNU Lesser General Public License
 along with this library; if not, write to the Free Software Foundation, Inc.,
 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA

 Contact information:

 IDgis bv
 Boomkamp 16
 7461 AX Rijssen
 The Netherlands
 http://idgis.nl/ 

 lat/lon GmbH
 Aennchenstr. 19, 53177 Bonn
 Germany
 http://lat-lon.de/

 Department of Geography, University of Bonn
 Prof. Dr. Klaus Greve
 Postfach 1147, 53001 Bonn
 Germany
 http://www.geographie.uni-bonn.de/deegree/

 e-mail: info@deegree.org
 ----------------------------------------------------------------------------*/
package org.deegree.sqldialect.oracle.sdo;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNotNull;
import static org.junit.Assert.assertTrue;
import static org.junit.Assert.fail;

import java.sql.SQLException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import org.deegree.geometry.Geometry;
import org.deegree.geometry.GeometryFactory;
import org.deegree.geometry.multi.MultiPolygon;
import org.deegree.geometry.points.Points;
import org.deegree.geometry.primitive.Curve;
import org.deegree.geometry.primitive.Point;
import org.deegree.geometry.primitive.Polygon;
import org.deegree.geometry.primitive.Ring;
import org.deegree.geometry.primitive.segments.ArcString;
import org.deegree.geometry.primitive.segments.CurveSegment;
import org.deegree.geometry.primitive.segments.LineStringSegment;

import org.deegree.sqldialect.oracle.sdo.SDOGeometryConverter.Triplet;

import org.junit.Test;

/**
 * Unit tests for {@link SDOGeometryConverter}
 * 
 * @author <a href="mailto:reijer.copier@idgis.nl">Reijer Copier</a>
 * 
 */
public class SDOGeometryConverterTest {

    final SDOGeometryConverter converter = new SDOGeometryConverter();

    final GeometryFactory geometryFactory = new GeometryFactory();

    @Test
    public void testMultiPolygonSimpleExteriorsCompoundInterior()
                            throws Exception {

        int gtype = 2003;
        int srid = 90112;

        int[] elemInfo = new int[] { 1, 1003, 1, 151, 1003, 1, 155, 2005, 4, 155, 2, 2, 159, 2, 1, 469, 2, 2, 473, 2, 1 };
        // int[] elemInfo = new int[] { 1, 1003, 1, 151, 1003, 1 };
        double[] ordinates = new double[] { 203709.598, 545665.225, 203711.469, 545658.621, 203712.911, 545655.267,
                                           203716.983, 545645.309, 203720.194, 545635.351, 203721.477, 545631.168,
                                           203724.103, 545625.393, 203727.924, 545615.435, 203730.95, 545605.477,
                                           203731.484, 545603.709, 203735.117, 545595.519, 203738.688, 545585.561,
                                           203741.491, 545576.173, 203741.754, 545575.603, 203746.163, 545565.646,
                                           203749.623, 545555.688, 203751.498, 545549.736, 203753.405, 545545.73,
                                           203757.6, 545535.772, 203760.91, 545525.814, 203761.506, 545524.015,
                                           203765.411, 545515.856, 203769.279, 545505.898, 203771.513, 545499.406,
                                           203773.253, 545495.94, 203777.828, 545485.982, 203781.52, 545476.354,
                                           203781.716, 545476.024, 203788.354, 545466.066, 203791.527, 545461.65,
                                           203800.664, 545456.108, 203801.534, 545455.703, 203810.342, 545456.108,
                                           203811.542, 545456.199, 203820.524, 545466.066, 203821.549, 545473.162,
                                           203821.731, 545476.024, 203821.549, 545476.896, 203818.882, 545485.982,
                                           203815.199, 545495.94, 203811.862, 545505.898, 203811.542, 545506.81,
                                           203807.009, 545515.856, 203803.16, 545525.814, 203801.534, 545530.689,
                                           203799.069, 545535.772, 203794.925, 545545.73, 203791.701, 545555.688,
                                           203791.527, 545556.233, 203787.24, 545565.646, 203783.619, 545575.603,
                                           203781.52, 545582.455, 203780.114, 545585.561, 203776.165, 545595.519,
                                           203772.919, 545605.477, 203771.513, 545610.118, 203769.14, 545615.435,
                                           203765.264, 545625.393, 203762.113, 545635.351, 203761.506, 545637.328,
                                           203757.936, 545645.309, 203754.287, 545655.267, 203751.498, 545664.375,
                                           203751.105, 545665.225, 203746.601, 545675.183, 203742.719, 545685.141,
                                           203741.491, 545688.114, 203736.457, 545695.098, 203731.484, 545700.813,
                                           203721.477, 545704.079, 203711.469, 545700.209, 203707.557, 545695.098,
                                           203705.615, 545685.141, 203707.099, 545675.183, 203709.598, 545665.225,
                                           82393.2189, 432423.2146, 82392.7854, 432416.1569, 82399.8431, 432415.7234,
                                           82412.3401, 432423.3519, 82416.0052, 432424.2142, 82421.5559, 432425.3934,
                                           82431.263, 432426.1248, 82445.0785, 432419.9118, 82453.937, 432417.0837,
                                           82463.293, 432414.6532, 82466.0049, 432413.0384, 82468.8305, 432411.3702,
                                           82472.3005, 432409.2533, 82479.0526, 432405.5055, 82481.6087, 432403.9937,
                                           82501.7327, 432391.0591, 82516.0075, 432381.1794, 82528.8381, 432372.169,
                                           82549.7045, 432357.2799, 82595.3413, 432324.4331, 82618.4103, 432307.9338,
                                           82668.7707, 432271.8773, 82714.1871, 432239.1364, 82783.5877, 432198.2748,
                                           82817.6858, 432210.0709, 82840.7293, 432216.6568, 82887.6614, 432200.5234,
                                           82911.1702, 432209.1713, 82945.1831, 432222.1225, 82964.1897, 432229.5321,
                                           83031.6253, 432255.9313, 83038.2641, 432258.4736, 83058.6287, 432266.5036,
                                           83072.6127, 432272.0004, 83089.7361, 432278.6847, 83110.8944, 432286.9015,
                                           83127.8402, 432293.47, 83131.8989, 432295.1396, 83145.7116, 432300.5285,
                                           83148.8655, 432301.7532, 83162.1045, 432306.4967, 83173.3604, 432310.6464,
                                           83197.9627, 432319.5132, 83207.1262, 432322.7911, 83216.8149, 432326.2436,
                                           83229.0501, 432330.3506, 83246.773, 432336.2166, 83258.3316, 432339.9503,
                                           83269.103, 432343.2642, 83283.1924, 432347.7244, 83291.418, 432350.2241,
                                           83297.9532, 432352.2492, 83306.5287, 432354.8328, 83314.7434, 432357.2496,
                                           83321.2777, 432359.2482, 83328.3156, 432361.3857, 83338.0664, 432364.0846,
                                           83346.4746, 432366.3767, 83354.4738, 432368.319, 83363.3328, 432370.3084,
                                           83372.1574, 432372.2721, 83381.5085, 432374.294, 83394.5354, 432376.9315,
                                           83403.9387, 432378.6014, 83415.2818, 432380.4378, 83431.6616, 432383.0264,
                                           83441.3652, 432384.4599, 83455.903, 432386.6121, 83471.1893, 432388.6716,
                                           83481.873, 432390.1411, 83493.6203, 432391.7658, 83500.6957, 432392.7366,
                                           83534.273, 432397.4545, 83571.7144, 432402.704, 83609.7171, 432407.9885,
                                           83629.5556, 432410.8307, 83671.2182, 432416.7046, 83712.5769, 432422.4875,
                                           83736.1375, 432425.828, 83753.3268, 432428.1424, 83829.1696, 432438.7695,
                                           83861.467, 432443.3934, 83898.4829, 432448.5771, 83945.4923, 432454.8605,
                                           83957.6569, 432456.6966, 83960.6081, 432457.1781, 83965.3061, 432458.0507,
                                           83971.2053, 432459.1142, 83980.5972, 432460.85, 83986.2168, 432461.9921,
                                           83990.6029, 432462.9585, 83996.223, 432464.1693, 84001.1526, 432465.3536,
                                           84006.7655, 432466.6647, 84019.8716, 432469.7578, 84044.4455, 432475.1557,
                                           84052.7288, 432477.4576, 84057.7979, 432478.9095, 84060.3328, 432479.4056,
                                           84069.7121, 432481.2311, 84072.7868, 432481.717, 84089.9228, 432484.4132,
                                           84095.6646, 432485.3783, 84106.7913, 432487.2216, 84114.4722, 432488.7113,
                                           84126.2788, 432490.8676, 84140.8888, 432493.6316, 84144.1992, 432494.3065,
                                           84147.772, 432495.1025, 84157.7207, 432497.7803, 84163.1885, 432499.1761,
                                           84178.4783, 432511.8593, 84177.5753, 432515.3113, 84171.7424, 432537.3317,
                                           84169.2593, 432546.8902, 84152.6487, 432562.5918, 84140.8763, 432560.2479,
                                           84129.0978, 432557.906, 84125.8873, 432557.281, 84117.3204, 432555.5964,
                                           84111.1917, 432554.4227, 84102.8876, 432553.0493, 84098.0539, 432579.2946,
                                           84088.5707, 432605.5144, 84077.1611, 432675.3089, 84074.4949, 432691.5724,
                                           84067.0782, 432736.0515, 84057.4224, 432793.2374, 84053.3248, 432817.5713,
                                           84046.217, 432858.6585, 84033.4529, 432933.6782, 84030.0201, 432954.0755,
                                           84023.3673, 432992.3382, 84018.4345, 433022.01, 84012.9065, 433053.9,
                                           84007.742, 433084.9643, 83999.5319, 433133.1785, 83995.0635, 433159.7365,
                                           83987.3993, 433205.2379, 83985.4684, 433216.6816, 83982.4817, 433234.2591,
                                           83978.5204, 433257.1358, 83973.9678, 433283.3718, 83964.9956, 433336.8815,
                                           83958.4786, 433376.5744, 83951.6201, 433417.6021, 83945.6518, 433453.5977,
                                           83939.1526, 433492.9064, 83934.8164, 433519.3445, 83929.2923, 433552.8449,
                                           83923.1682, 433589.9645, 83916.476, 433631.0894, 83904.9437, 433681.0462,
                                           83901.9415, 433684.6096, 83898.5524, 433687.5776, 83874.7209, 433704.1055,
                                           83868.1428, 433708.6889, 83865.9354, 433721.5047, 83860.197, 433725.5898,
                                           83856.0682, 433719.8827, 84048.9233, 432486.8368, 84017.5785, 432479.4913,
                                           84004.4741, 432476.3986, 83998.832, 432475.0807, 83993.9449, 432473.9066,
                                           83988.4632, 432472.7269, 83984.1054, 432471.7668, 83978.6502, 432470.6588,
                                           83969.3993, 432468.9498, 83963.4929, 432467.8849, 83958.8368, 432467.0201,
                                           83951.4884, 432465.7884, 83944.1301, 432464.7673, 83897.1116, 432458.4827,
                                           83860.0574, 432453.2935, 83827.7598, 432448.6696, 83751.9525, 432438.0475,
                                           83734.7511, 432435.7315, 83711.1779, 432432.3892, 83669.825, 432426.607,
                                           83628.1429, 432420.7305, 83608.3091, 432417.8889, 83570.3288, 432412.6076,
                                           83532.8823, 432407.3574, 83499.3123, 432402.6405, 83492.253, 432401.6719,
                                           83480.5049, 432400.0471, 83469.8335, 432398.5793, 83454.4708, 432396.5091,
                                           83439.9015, 432394.3522, 83430.1255, 432392.9077, 83413.6929, 432390.3107,
                                           83402.2278, 432388.454, 83392.6098, 432386.7446, 83379.4273, 432384.0751,
                                           83369.9999, 432382.0366, 83361.1464, 432380.0665, 83352.1562, 432378.0468,
                                           83343.912, 432376.043, 83335.4082, 432373.7248, 83325.469, 432370.9722,
                                           83318.3576, 432368.8124, 83311.8442, 432366.8202, 83303.6597, 432364.4124,
                                           83295.012, 432361.8069, 83288.4711, 432359.78, 83280.202, 432357.2668,
                                           83266.1044, 432352.804, 83255.2911, 432349.4769, 83243.6479, 432345.7157,
                                           83225.8779, 432339.8341, 83213.5017, 432335.6789, 83203.7609, 432332.2078,
                                           83194.5777, 432328.9228, 83169.9185, 432320.0353, 83158.667, 432315.8873,
                                           83145.3071, 432311.0989, 83142.0807, 432309.846, 83128.1368, 432304.405,
                                           83124.0833, 432302.7376, 83107.276, 432296.2239, 83086.1038, 432288.0017,
                                           83068.9598, 432281.3094, 83054.9629, 432275.8074, 83034.6189, 432267.7855,
                                           83027.9973, 432265.2499, 82960.5476, 432238.8452, 82941.5693, 432231.4467,
                                           82907.6383, 432218.5268, 82879.3048, 432209.9325, 82834.1582, 432226.5541,
                                           82814.3517, 432219.4988, 82773.0839, 432208.7663, 82720.0409, 432247.2439,
                                           82674.5987, 432280.0034, 82624.2287, 432316.0669, 82601.1648, 432332.5625,
                                           82555.5212, 432365.4141, 82534.6005, 432380.3418, 82521.7125, 432389.3923,
                                           82507.2115, 432399.4251, 82486.7794, 432412.5536, 82483.9655, 432414.2157,
                                           82477.2457, 432417.9456, 82473.9481, 432419.9616, 82471.0971, 432421.6448,
                                           82445.3271, 432431.6688, 82442.4851, 432433.1091, 82436.1644, 432435.3401,
                                           82433.1705, 432435.9412, 82429.625, 432436.531, 82422.4991, 432435.9196,
                                           82419.2538, 432435.1251, 82413.7689, 432433.9611, 82397.9539, 432427.4016,
                                           82393.2189, 432423.2146, 84058.8188, 432489.2986, 83870.0584, 433695.1695,
                                           83900.0704, 433667.8566, 83906.6149, 433629.4287, 83913.3007, 433588.3421,
                                           83919.4257, 433551.2173, 83924.9493, 433517.7196, 83929.286, 433491.2784,
                                           83935.7863, 433451.9631, 83941.7564, 433415.9566, 83948.6142, 433374.9328,
                                           83955.1318, 433335.2362, 83964.1126, 433281.6762, 83968.6675, 433255.427,
                                           83972.627, 433232.5607, 83975.6092, 433215.0093, 83977.5386, 433203.5748,
                                           83985.2024, 433158.076, 83989.673, 433131.5047, 83997.8823, 433083.2953,
                                           84003.0505, 433052.209, 84008.5785, 433020.319, 84013.5119, 432990.6435,
                                           84020.1656, 432952.3758, 84023.5938, 432932.0053, 84036.3622, 432856.9607,
                                           84043.4693, 432815.8777, 84047.5618, 432791.5735, 84057.2169, 432734.3916,
                                           84064.63, 432689.9344, 84067.2927, 432673.6922, 84079.0091, 432602.5494,
                                           84088.5073, 432576.2882, 84103.6289, 432543.036, 84113.0105, 432544.5893,
                                           84119.2377, 432545.782, 84127.812, 432547.468, 84131.0381, 432548.096,
                                           84142.8283, 432550.4402, 84157.4833, 432552.3942, 84159.5837, 432544.3638,
                                           84162.0727, 432534.7827, 84166.3463, 432510.2053, 84160.7553, 432508.8757,
                                           84148.1332, 432505.5377, 84145.3225, 432504.7983, 84142.0769, 432504.0788,
                                           84135.1982, 432502.7264, 84124.4395, 432500.697, 84112.595, 432498.5335,
                                           84098.2177, 432495.9074, 84094.0302, 432495.2438, 84088.2911, 432494.2792,
                                           84071.2275, 432491.5947, 84067.8887, 432491.0639, 84058.8188, 432489.2986 };

        testMultiPolygon( 2, new int[] { 0, 1 }, gtype, srid, elemInfo, ordinates );
    }

    @Test
    public void testMultiPolygonSimpleExteriorComplexExteriorSimpleInterior()
                            throws Exception {
        int gtype = 2003;
        int srid = 90112;

        int[] elemInfo = new int[] { 1, 1003, 1, 151, 1003, 1 };
        double[] ordinates = new double[] { 203709.598, 545665.225, 203711.469, 545658.621, 203712.911, 545655.267,
                                           203716.983, 545645.309, 203720.194, 545635.351, 203721.477, 545631.168,
                                           203724.103, 545625.393, 203727.924, 545615.435, 203730.95, 545605.477,
                                           203731.484, 545603.709, 203735.117, 545595.519, 203738.688, 545585.561,
                                           203741.491, 545576.173, 203741.754, 545575.603, 203746.163, 545565.646,
                                           203749.623, 545555.688, 203751.498, 545549.736, 203753.405, 545545.73,
                                           203757.6, 545535.772, 203760.91, 545525.814, 203761.506, 545524.015,
                                           203765.411, 545515.856, 203769.279, 545505.898, 203771.513, 545499.406,
                                           203773.253, 545495.94, 203777.828, 545485.982, 203781.52, 545476.354,
                                           203781.716, 545476.024, 203788.354, 545466.066, 203791.527, 545461.65,
                                           203800.664, 545456.108, 203801.534, 545455.703, 203810.342, 545456.108,
                                           203811.542, 545456.199, 203820.524, 545466.066, 203821.549, 545473.162,
                                           203821.731, 545476.024, 203821.549, 545476.896, 203818.882, 545485.982,
                                           203815.199, 545495.94, 203811.862, 545505.898, 203811.542, 545506.81,
                                           203807.009, 545515.856, 203803.16, 545525.814, 203801.534, 545530.689,
                                           203799.069, 545535.772, 203794.925, 545545.73, 203791.701, 545555.688,
                                           203791.527, 545556.233, 203787.24, 545565.646, 203783.619, 545575.603,
                                           203781.52, 545582.455, 203780.114, 545585.561, 203776.165, 545595.519,
                                           203772.919, 545605.477, 203771.513, 545610.118, 203769.14, 545615.435,
                                           203765.264, 545625.393, 203762.113, 545635.351, 203761.506, 545637.328,
                                           203757.936, 545645.309, 203754.287, 545655.267, 203751.498, 545664.375,
                                           203751.105, 545665.225, 203746.601, 545675.183, 203742.719, 545685.141,
                                           203741.491, 545688.114, 203736.457, 545695.098, 203731.484, 545700.813,
                                           203721.477, 545704.079, 203711.469, 545700.209, 203707.557, 545695.098,
                                           203705.615, 545685.141, 203707.099, 545675.183, 203709.598, 545665.225,
                                           82393.2189, 432423.2146, 82392.7854, 432416.1569, 82399.8431, 432415.7234,
                                           82412.3401, 432423.3519, 82416.0052, 432424.2142, 82421.5559, 432425.3934,
                                           82431.263, 432426.1248, 82445.0785, 432419.9118, 82453.937, 432417.0837,
                                           82463.293, 432414.6532, 82466.0049, 432413.0384, 82468.8305, 432411.3702,
                                           82472.3005, 432409.2533, 82479.0526, 432405.5055, 82481.6087, 432403.9937,
                                           82501.7327, 432391.0591, 82516.0075, 432381.1794, 82528.8381, 432372.169,
                                           82549.7045, 432357.2799, 82595.3413, 432324.4331, 82618.4103, 432307.9338,
                                           82668.7707, 432271.8773, 82714.1871, 432239.1364, 82783.5877, 432198.2748,
                                           82817.6858, 432210.0709, 82840.7293, 432216.6568, 82887.6614, 432200.5234,
                                           82911.1702, 432209.1713, 82945.1831, 432222.1225, 82964.1897, 432229.5321,
                                           83031.6253, 432255.9313, 83038.2641, 432258.4736, 83058.6287, 432266.5036,
                                           83072.6127, 432272.0004, 83089.7361, 432278.6847, 83110.8944, 432286.9015,
                                           83127.8402, 432293.47, 83131.8989, 432295.1396, 83145.7116, 432300.5285,
                                           83148.8655, 432301.7532, 83162.1045, 432306.4967, 83173.3604, 432310.6464,
                                           83197.9627, 432319.5132, 83207.1262, 432322.7911, 83216.8149, 432326.2436,
                                           83229.0501, 432330.3506, 83246.773, 432336.2166, 83258.3316, 432339.9503,
                                           83269.103, 432343.2642, 83283.1924, 432347.7244, 83291.418, 432350.2241,
                                           83297.9532, 432352.2492, 83306.5287, 432354.8328, 83314.7434, 432357.2496,
                                           83321.2777, 432359.2482, 83328.3156, 432361.3857, 83338.0664, 432364.0846,
                                           83346.4746, 432366.3767, 83354.4738, 432368.319, 83363.3328, 432370.3084,
                                           83372.1574, 432372.2721, 83381.5085, 432374.294, 83394.5354, 432376.9315,
                                           83403.9387, 432378.6014, 83415.2818, 432380.4378, 83431.6616, 432383.0264,
                                           83441.3652, 432384.4599, 83455.903, 432386.6121, 83471.1893, 432388.6716,
                                           83481.873, 432390.1411, 83493.6203, 432391.7658, 83500.6957, 432392.7366,
                                           83534.273, 432397.4545, 83571.7144, 432402.704, 83609.7171, 432407.9885,
                                           83629.5556, 432410.8307, 83671.2182, 432416.7046, 83712.5769, 432422.4875,
                                           83736.1375, 432425.828, 83753.3268, 432428.1424, 83829.1696, 432438.7695,
                                           83861.467, 432443.3934, 83898.4829, 432448.5771, 83945.4923, 432454.8605,
                                           83957.6569, 432456.6966, 83960.6081, 432457.1781, 83965.3061, 432458.0507,
                                           83971.2053, 432459.1142, 83980.5972, 432460.85, 83986.2168, 432461.9921,
                                           83990.6029, 432462.9585, 83996.223, 432464.1693, 84001.1526, 432465.3536,
                                           84006.7655, 432466.6647, 84019.8716, 432469.7578, 84044.4455, 432475.1557,
                                           84052.7288, 432477.4576, 84057.7979, 432478.9095, 84060.3328, 432479.4056,
                                           84069.7121, 432481.2311, 84072.7868, 432481.717, 84089.9228, 432484.4132,
                                           84095.6646, 432485.3783, 84106.7913, 432487.2216, 84114.4722, 432488.7113,
                                           84126.2788, 432490.8676, 84140.8888, 432493.6316, 84144.1992, 432494.3065,
                                           84147.772, 432495.1025, 84157.7207, 432497.7803, 84163.1885, 432499.1761,
                                           84178.4783, 432511.8593, 84177.5753, 432515.3113, 84171.7424, 432537.3317,
                                           84169.2593, 432546.8902, 84152.6487, 432562.5918, 84140.8763, 432560.2479,
                                           84129.0978, 432557.906, 84125.8873, 432557.281, 84117.3204, 432555.5964,
                                           84111.1917, 432554.4227, 84102.8876, 432553.0493, 84098.0539, 432579.2946,
                                           84088.5707, 432605.5144, 84077.1611, 432675.3089, 84074.4949, 432691.5724,
                                           84067.0782, 432736.0515, 84057.4224, 432793.2374, 84053.3248, 432817.5713,
                                           84046.217, 432858.6585, 84033.4529, 432933.6782, 84030.0201, 432954.0755,
                                           84023.3673, 432992.3382, 84018.4345, 433022.01, 84012.9065, 433053.9,
                                           84007.742, 433084.9643, 83999.5319, 433133.1785, 83995.0635, 433159.7365,
                                           83987.3993, 433205.2379, 83985.4684, 433216.6816, 83982.4817, 433234.2591,
                                           83978.5204, 433257.1358, 83973.9678, 433283.3718, 83964.9956, 433336.8815,
                                           83958.4786, 433376.5744, 83951.6201, 433417.6021, 83945.6518, 433453.5977,
                                           83939.1526, 433492.9064, 83934.8164, 433519.3445, 83929.2923, 433552.8449,
                                           83923.1682, 433589.9645, 83916.476, 433631.0894, 83904.9437, 433681.0462,
                                           83901.9415, 433684.6096, 83898.5524, 433687.5776, 83874.7209, 433704.1055,
                                           83868.1428, 433708.6889, 83865.9354, 433721.5047, 83860.197, 433725.5898,
                                           83856.0682, 433719.8827, 84048.9233, 432486.8368, 84017.5785, 432479.4913,
                                           84004.4741, 432476.3986, 83998.832, 432475.0807, 83993.9449, 432473.9066,
                                           83988.4632, 432472.7269, 83984.1054, 432471.7668, 83978.6502, 432470.6588,
                                           83969.3993, 432468.9498, 83963.4929, 432467.8849, 83958.8368, 432467.0201,
                                           83951.4884, 432465.7884, 83944.1301, 432464.7673, 83897.1116, 432458.4827,
                                           83860.0574, 432453.2935, 83827.7598, 432448.6696, 83751.9525, 432438.0475,
                                           83734.7511, 432435.7315, 83711.1779, 432432.3892, 83669.825, 432426.607,
                                           83628.1429, 432420.7305, 83608.3091, 432417.8889, 83570.3288, 432412.6076,
                                           83532.8823, 432407.3574, 83499.3123, 432402.6405, 83492.253, 432401.6719,
                                           83480.5049, 432400.0471, 83469.8335, 432398.5793, 83454.4708, 432396.5091,
                                           83439.9015, 432394.3522, 83430.1255, 432392.9077, 83413.6929, 432390.3107,
                                           83402.2278, 432388.454, 83392.6098, 432386.7446, 83379.4273, 432384.0751,
                                           83369.9999, 432382.0366, 83361.1464, 432380.0665, 83352.1562, 432378.0468,
                                           83343.912, 432376.043, 83335.4082, 432373.7248, 83325.469, 432370.9722,
                                           83318.3576, 432368.8124, 83311.8442, 432366.8202, 83303.6597, 432364.4124,
                                           83295.012, 432361.8069, 83288.4711, 432359.78, 83280.202, 432357.2668,
                                           83266.1044, 432352.804, 83255.2911, 432349.4769, 83243.6479, 432345.7157,
                                           83225.8779, 432339.8341, 83213.5017, 432335.6789, 83203.7609, 432332.2078,
                                           83194.5777, 432328.9228, 83169.9185, 432320.0353, 83158.667, 432315.8873,
                                           83145.3071, 432311.0989, 83142.0807, 432309.846, 83128.1368, 432304.405,
                                           83124.0833, 432302.7376, 83107.276, 432296.2239, 83086.1038, 432288.0017,
                                           83068.9598, 432281.3094, 83054.9629, 432275.8074, 83034.6189, 432267.7855,
                                           83027.9973, 432265.2499, 82960.5476, 432238.8452, 82941.5693, 432231.4467,
                                           82907.6383, 432218.5268, 82879.3048, 432209.9325, 82834.1582, 432226.5541,
                                           82814.3517, 432219.4988, 82773.0839, 432208.7663, 82720.0409, 432247.2439,
                                           82674.5987, 432280.0034, 82624.2287, 432316.0669, 82601.1648, 432332.5625,
                                           82555.5212, 432365.4141, 82534.6005, 432380.3418, 82521.7125, 432389.3923,
                                           82507.2115, 432399.4251, 82486.7794, 432412.5536, 82483.9655, 432414.2157,
                                           82477.2457, 432417.9456, 82473.9481, 432419.9616, 82471.0971, 432421.6448,
                                           82445.3271, 432431.6688, 82442.4851, 432433.1091, 82436.1644, 432435.3401,
                                           82433.1705, 432435.9412, 82429.625, 432436.531, 82422.4991, 432435.9196,
                                           82419.2538, 432435.1251, 82413.7689, 432433.9611, 82397.9539, 432427.4016,
                                           82393.2189, 432423.2146 };

        testMultiPolygon( 2, new int[] { 0, 0 }, gtype, srid, elemInfo, ordinates );
    }

    @Test
    public void testPolygonSimpleExterior()
                            throws Exception {
        int gtype = 2003;
        int srid = 90112;

        int[] elemInfo = new int[] { 1, 1003, 1 };
        double[] ordinates = new double[] { 203709.598, 545665.225, 203711.469, 545658.621, 203712.911, 545655.267,
                                           203716.983, 545645.309, 203720.194, 545635.351, 203721.477, 545631.168,
                                           203724.103, 545625.393, 203727.924, 545615.435, 203730.95, 545605.477,
                                           203731.484, 545603.709, 203735.117, 545595.519, 203738.688, 545585.561,
                                           203741.491, 545576.173, 203741.754, 545575.603, 203746.163, 545565.646,
                                           203749.623, 545555.688, 203751.498, 545549.736, 203753.405, 545545.73,
                                           203757.6, 545535.772, 203760.91, 545525.814, 203761.506, 545524.015,
                                           203765.411, 545515.856, 203769.279, 545505.898, 203771.513, 545499.406,
                                           203773.253, 545495.94, 203777.828, 545485.982, 203781.52, 545476.354,
                                           203781.716, 545476.024, 203788.354, 545466.066, 203791.527, 545461.65,
                                           203800.664, 545456.108, 203801.534, 545455.703, 203810.342, 545456.108,
                                           203811.542, 545456.199, 203820.524, 545466.066, 203821.549, 545473.162,
                                           203821.731, 545476.024, 203821.549, 545476.896, 203818.882, 545485.982,
                                           203815.199, 545495.94, 203811.862, 545505.898, 203811.542, 545506.81,
                                           203807.009, 545515.856, 203803.16, 545525.814, 203801.534, 545530.689,
                                           203799.069, 545535.772, 203794.925, 545545.73, 203791.701, 545555.688,
                                           203791.527, 545556.233, 203787.24, 545565.646, 203783.619, 545575.603,
                                           203781.52, 545582.455, 203780.114, 545585.561, 203776.165, 545595.519,
                                           203772.919, 545605.477, 203771.513, 545610.118, 203769.14, 545615.435,
                                           203765.264, 545625.393, 203762.113, 545635.351, 203761.506, 545637.328,
                                           203757.936, 545645.309, 203754.287, 545655.267, 203751.498, 545664.375,
                                           203751.105, 545665.225, 203746.601, 545675.183, 203742.719, 545685.141,
                                           203741.491, 545688.114, 203736.457, 545695.098, 203731.484, 545700.813,
                                           203721.477, 545704.079, 203711.469, 545700.209, 203707.557, 545695.098,
                                           203705.615, 545685.141, 203707.099, 545675.183, 203709.598, 545665.225 };

        testPolygon( 0, gtype, srid, elemInfo, ordinates );
    }

    @Test
    public void testPolygonCompoundExterior()
                            throws Exception {
        int gtype = 2003;
        int srid = 90112;

        int[] elemInfo = new int[] { 1, 1005, 4, 1, 2, 2, 5, 2, 1, 315, 2, 2, 319, 2, 1 };
        double[] ordinates = new double[] { 82393.2189, 432423.2146, 82392.7854, 432416.1569, 82399.8431, 432415.7234,
                                           82412.3401, 432423.3519, 82416.0052, 432424.2142, 82421.5559, 432425.3934,
                                           82431.263, 432426.1248, 82445.0785, 432419.9118, 82453.937, 432417.0837,
                                           82463.293, 432414.6532, 82466.0049, 432413.0384, 82468.8305, 432411.3702,
                                           82472.3005, 432409.2533, 82479.0526, 432405.5055, 82481.6087, 432403.9937,
                                           82501.7327, 432391.0591, 82516.0075, 432381.1794, 82528.8381, 432372.169,
                                           82549.7045, 432357.2799, 82595.3413, 432324.4331, 82618.4103, 432307.9338,
                                           82668.7707, 432271.8773, 82714.1871, 432239.1364, 82783.5877, 432198.2748,
                                           82817.6858, 432210.0709, 82840.7293, 432216.6568, 82887.6614, 432200.5234,
                                           82911.1702, 432209.1713, 82945.1831, 432222.1225, 82964.1897, 432229.5321,
                                           83031.6253, 432255.9313, 83038.2641, 432258.4736, 83058.6287, 432266.5036,
                                           83072.6127, 432272.0004, 83089.7361, 432278.6847, 83110.8944, 432286.9015,
                                           83127.8402, 432293.47, 83131.8989, 432295.1396, 83145.7116, 432300.5285,
                                           83148.8655, 432301.7532, 83162.1045, 432306.4967, 83173.3604, 432310.6464,
                                           83197.9627, 432319.5132, 83207.1262, 432322.7911, 83216.8149, 432326.2436,
                                           83229.0501, 432330.3506, 83246.773, 432336.2166, 83258.3316, 432339.9503,
                                           83269.103, 432343.2642, 83283.1924, 432347.7244, 83291.418, 432350.2241,
                                           83297.9532, 432352.2492, 83306.5287, 432354.8328, 83314.7434, 432357.2496,
                                           83321.2777, 432359.2482, 83328.3156, 432361.3857, 83338.0664, 432364.0846,
                                           83346.4746, 432366.3767, 83354.4738, 432368.319, 83363.3328, 432370.3084,
                                           83372.1574, 432372.2721, 83381.5085, 432374.294, 83394.5354, 432376.9315,
                                           83403.9387, 432378.6014, 83415.2818, 432380.4378, 83431.6616, 432383.0264,
                                           83441.3652, 432384.4599, 83455.903, 432386.6121, 83471.1893, 432388.6716,
                                           83481.873, 432390.1411, 83493.6203, 432391.7658, 83500.6957, 432392.7366,
                                           83534.273, 432397.4545, 83571.7144, 432402.704, 83609.7171, 432407.9885,
                                           83629.5556, 432410.8307, 83671.2182, 432416.7046, 83712.5769, 432422.4875,
                                           83736.1375, 432425.828, 83753.3268, 432428.1424, 83829.1696, 432438.7695,
                                           83861.467, 432443.3934, 83898.4829, 432448.5771, 83945.4923, 432454.8605,
                                           83957.6569, 432456.6966, 83960.6081, 432457.1781, 83965.3061, 432458.0507,
                                           83971.2053, 432459.1142, 83980.5972, 432460.85, 83986.2168, 432461.9921,
                                           83990.6029, 432462.9585, 83996.223, 432464.1693, 84001.1526, 432465.3536,
                                           84006.7655, 432466.6647, 84019.8716, 432469.7578, 84044.4455, 432475.1557,
                                           84052.7288, 432477.4576, 84057.7979, 432478.9095, 84060.3328, 432479.4056,
                                           84069.7121, 432481.2311, 84072.7868, 432481.717, 84089.9228, 432484.4132,
                                           84095.6646, 432485.3783, 84106.7913, 432487.2216, 84114.4722, 432488.7113,
                                           84126.2788, 432490.8676, 84140.8888, 432493.6316, 84144.1992, 432494.3065,
                                           84147.772, 432495.1025, 84157.7207, 432497.7803, 84163.1885, 432499.1761,
                                           84178.4783, 432511.8593, 84177.5753, 432515.3113, 84171.7424, 432537.3317,
                                           84169.2593, 432546.8902, 84152.6487, 432562.5918, 84140.8763, 432560.2479,
                                           84129.0978, 432557.906, 84125.8873, 432557.281, 84117.3204, 432555.5964,
                                           84111.1917, 432554.4227, 84102.8876, 432553.0493, 84098.0539, 432579.2946,
                                           84088.5707, 432605.5144, 84077.1611, 432675.3089, 84074.4949, 432691.5724,
                                           84067.0782, 432736.0515, 84057.4224, 432793.2374, 84053.3248, 432817.5713,
                                           84046.217, 432858.6585, 84033.4529, 432933.6782, 84030.0201, 432954.0755,
                                           84023.3673, 432992.3382, 84018.4345, 433022.01, 84012.9065, 433053.9,
                                           84007.742, 433084.9643, 83999.5319, 433133.1785, 83995.0635, 433159.7365,
                                           83987.3993, 433205.2379, 83985.4684, 433216.6816, 83982.4817, 433234.2591,
                                           83978.5204, 433257.1358, 83973.9678, 433283.3718, 83964.9956, 433336.8815,
                                           83958.4786, 433376.5744, 83951.6201, 433417.6021, 83945.6518, 433453.5977,
                                           83939.1526, 433492.9064, 83934.8164, 433519.3445, 83929.2923, 433552.8449,
                                           83923.1682, 433589.9645, 83916.476, 433631.0894, 83904.9437, 433681.0462,
                                           83901.9415, 433684.6096, 83898.5524, 433687.5776, 83874.7209, 433704.1055,
                                           83868.1428, 433708.6889, 83865.9354, 433721.5047, 83860.197, 433725.5898,
                                           83856.0682, 433719.8827, 84048.9233, 432486.8368, 84017.5785, 432479.4913,
                                           84004.4741, 432476.3986, 83998.832, 432475.0807, 83993.9449, 432473.9066,
                                           83988.4632, 432472.7269, 83984.1054, 432471.7668, 83978.6502, 432470.6588,
                                           83969.3993, 432468.9498, 83963.4929, 432467.8849, 83958.8368, 432467.0201,
                                           83951.4884, 432465.7884, 83944.1301, 432464.7673, 83897.1116, 432458.4827,
                                           83860.0574, 432453.2935, 83827.7598, 432448.6696, 83751.9525, 432438.0475,
                                           83734.7511, 432435.7315, 83711.1779, 432432.3892, 83669.825, 432426.607,
                                           83628.1429, 432420.7305, 83608.3091, 432417.8889, 83570.3288, 432412.6076,
                                           83532.8823, 432407.3574, 83499.3123, 432402.6405, 83492.253, 432401.6719,
                                           83480.5049, 432400.0471, 83469.8335, 432398.5793, 83454.4708, 432396.5091,
                                           83439.9015, 432394.3522, 83430.1255, 432392.9077, 83413.6929, 432390.3107,
                                           83402.2278, 432388.454, 83392.6098, 432386.7446, 83379.4273, 432384.0751,
                                           83369.9999, 432382.0366, 83361.1464, 432380.0665, 83352.1562, 432378.0468,
                                           83343.912, 432376.043, 83335.4082, 432373.7248, 83325.469, 432370.9722,
                                           83318.3576, 432368.8124, 83311.8442, 432366.8202, 83303.6597, 432364.4124,
                                           83295.012, 432361.8069, 83288.4711, 432359.78, 83280.202, 432357.2668,
                                           83266.1044, 432352.804, 83255.2911, 432349.4769, 83243.6479, 432345.7157,
                                           83225.8779, 432339.8341, 83213.5017, 432335.6789, 83203.7609, 432332.2078,
                                           83194.5777, 432328.9228, 83169.9185, 432320.0353, 83158.667, 432315.8873,
                                           83145.3071, 432311.0989, 83142.0807, 432309.846, 83128.1368, 432304.405,
                                           83124.0833, 432302.7376, 83107.276, 432296.2239, 83086.1038, 432288.0017,
                                           83068.9598, 432281.3094, 83054.9629, 432275.8074, 83034.6189, 432267.7855,
                                           83027.9973, 432265.2499, 82960.5476, 432238.8452, 82941.5693, 432231.4467,
                                           82907.6383, 432218.5268, 82879.3048, 432209.9325, 82834.1582, 432226.5541,
                                           82814.3517, 432219.4988, 82773.0839, 432208.7663, 82720.0409, 432247.2439,
                                           82674.5987, 432280.0034, 82624.2287, 432316.0669, 82601.1648, 432332.5625,
                                           82555.5212, 432365.4141, 82534.6005, 432380.3418, 82521.7125, 432389.3923,
                                           82507.2115, 432399.4251, 82486.7794, 432412.5536, 82483.9655, 432414.2157,
                                           82477.2457, 432417.9456, 82473.9481, 432419.9616, 82471.0971, 432421.6448,
                                           82445.3271, 432431.6688, 82442.4851, 432433.1091, 82436.1644, 432435.3401,
                                           82433.1705, 432435.9412, 82429.625, 432436.531, 82422.4991, 432435.9196,
                                           82419.2538, 432435.1251, 82413.7689, 432433.9611, 82397.9539, 432427.4016,
                                           82393.2189, 432423.2146 };

        testPolygon( 0, gtype, srid, elemInfo, ordinates );
    }

    @Test
    public void testPolygonSimpleExteriorCompoundInterior()
                            throws Exception {
        int gtype = 2003;
        int srid = 90112;

        int[] elemInfo = new int[] { 1, 1003, 1, 5, 2005, 4, 5, 2, 2, 9, 2, 1, 319, 2, 2, 323, 2, 1 };
        double[] ordinates = new double[] { 0, 0, 100000, 0, 100000, 100000, 0, 100000, 82393.2189, 432423.2146,
                                           82392.7854, 432416.1569, 82399.8431, 432415.7234, 82412.3401, 432423.3519,
                                           82416.0052, 432424.2142, 82421.5559, 432425.3934, 82431.263, 432426.1248,
                                           82445.0785, 432419.9118, 82453.937, 432417.0837, 82463.293, 432414.6532,
                                           82466.0049, 432413.0384, 82468.8305, 432411.3702, 82472.3005, 432409.2533,
                                           82479.0526, 432405.5055, 82481.6087, 432403.9937, 82501.7327, 432391.0591,
                                           82516.0075, 432381.1794, 82528.8381, 432372.169, 82549.7045, 432357.2799,
                                           82595.3413, 432324.4331, 82618.4103, 432307.9338, 82668.7707, 432271.8773,
                                           82714.1871, 432239.1364, 82783.5877, 432198.2748, 82817.6858, 432210.0709,
                                           82840.7293, 432216.6568, 82887.6614, 432200.5234, 82911.1702, 432209.1713,
                                           82945.1831, 432222.1225, 82964.1897, 432229.5321, 83031.6253, 432255.9313,
                                           83038.2641, 432258.4736, 83058.6287, 432266.5036, 83072.6127, 432272.0004,
                                           83089.7361, 432278.6847, 83110.8944, 432286.9015, 83127.8402, 432293.47,
                                           83131.8989, 432295.1396, 83145.7116, 432300.5285, 83148.8655, 432301.7532,
                                           83162.1045, 432306.4967, 83173.3604, 432310.6464, 83197.9627, 432319.5132,
                                           83207.1262, 432322.7911, 83216.8149, 432326.2436, 83229.0501, 432330.3506,
                                           83246.773, 432336.2166, 83258.3316, 432339.9503, 83269.103, 432343.2642,
                                           83283.1924, 432347.7244, 83291.418, 432350.2241, 83297.9532, 432352.2492,
                                           83306.5287, 432354.8328, 83314.7434, 432357.2496, 83321.2777, 432359.2482,
                                           83328.3156, 432361.3857, 83338.0664, 432364.0846, 83346.4746, 432366.3767,
                                           83354.4738, 432368.319, 83363.3328, 432370.3084, 83372.1574, 432372.2721,
                                           83381.5085, 432374.294, 83394.5354, 432376.9315, 83403.9387, 432378.6014,
                                           83415.2818, 432380.4378, 83431.6616, 432383.0264, 83441.3652, 432384.4599,
                                           83455.903, 432386.6121, 83471.1893, 432388.6716, 83481.873, 432390.1411,
                                           83493.6203, 432391.7658, 83500.6957, 432392.7366, 83534.273, 432397.4545,
                                           83571.7144, 432402.704, 83609.7171, 432407.9885, 83629.5556, 432410.8307,
                                           83671.2182, 432416.7046, 83712.5769, 432422.4875, 83736.1375, 432425.828,
                                           83753.3268, 432428.1424, 83829.1696, 432438.7695, 83861.467, 432443.3934,
                                           83898.4829, 432448.5771, 83945.4923, 432454.8605, 83957.6569, 432456.6966,
                                           83960.6081, 432457.1781, 83965.3061, 432458.0507, 83971.2053, 432459.1142,
                                           83980.5972, 432460.85, 83986.2168, 432461.9921, 83990.6029, 432462.9585,
                                           83996.223, 432464.1693, 84001.1526, 432465.3536, 84006.7655, 432466.6647,
                                           84019.8716, 432469.7578, 84044.4455, 432475.1557, 84052.7288, 432477.4576,
                                           84057.7979, 432478.9095, 84060.3328, 432479.4056, 84069.7121, 432481.2311,
                                           84072.7868, 432481.717, 84089.9228, 432484.4132, 84095.6646, 432485.3783,
                                           84106.7913, 432487.2216, 84114.4722, 432488.7113, 84126.2788, 432490.8676,
                                           84140.8888, 432493.6316, 84144.1992, 432494.3065, 84147.772, 432495.1025,
                                           84157.7207, 432497.7803, 84163.1885, 432499.1761, 84178.4783, 432511.8593,
                                           84177.5753, 432515.3113, 84171.7424, 432537.3317, 84169.2593, 432546.8902,
                                           84152.6487, 432562.5918, 84140.8763, 432560.2479, 84129.0978, 432557.906,
                                           84125.8873, 432557.281, 84117.3204, 432555.5964, 84111.1917, 432554.4227,
                                           84102.8876, 432553.0493, 84098.0539, 432579.2946, 84088.5707, 432605.5144,
                                           84077.1611, 432675.3089, 84074.4949, 432691.5724, 84067.0782, 432736.0515,
                                           84057.4224, 432793.2374, 84053.3248, 432817.5713, 84046.217, 432858.6585,
                                           84033.4529, 432933.6782, 84030.0201, 432954.0755, 84023.3673, 432992.3382,
                                           84018.4345, 433022.01, 84012.9065, 433053.9, 84007.742, 433084.9643,
                                           83999.5319, 433133.1785, 83995.0635, 433159.7365, 83987.3993, 433205.2379,
                                           83985.4684, 433216.6816, 83982.4817, 433234.2591, 83978.5204, 433257.1358,
                                           83973.9678, 433283.3718, 83964.9956, 433336.8815, 83958.4786, 433376.5744,
                                           83951.6201, 433417.6021, 83945.6518, 433453.5977, 83939.1526, 433492.9064,
                                           83934.8164, 433519.3445, 83929.2923, 433552.8449, 83923.1682, 433589.9645,
                                           83916.476, 433631.0894, 83904.9437, 433681.0462, 83901.9415, 433684.6096,
                                           83898.5524, 433687.5776, 83874.7209, 433704.1055, 83868.1428, 433708.6889,
                                           83865.9354, 433721.5047, 83860.197, 433725.5898, 83856.0682, 433719.8827,
                                           84048.9233, 432486.8368, 84017.5785, 432479.4913, 84004.4741, 432476.3986,
                                           83998.832, 432475.0807, 83993.9449, 432473.9066, 83988.4632, 432472.7269,
                                           83984.1054, 432471.7668, 83978.6502, 432470.6588, 83969.3993, 432468.9498,
                                           83963.4929, 432467.8849, 83958.8368, 432467.0201, 83951.4884, 432465.7884,
                                           83944.1301, 432464.7673, 83897.1116, 432458.4827, 83860.0574, 432453.2935,
                                           83827.7598, 432448.6696, 83751.9525, 432438.0475, 83734.7511, 432435.7315,
                                           83711.1779, 432432.3892, 83669.825, 432426.607, 83628.1429, 432420.7305,
                                           83608.3091, 432417.8889, 83570.3288, 432412.6076, 83532.8823, 432407.3574,
                                           83499.3123, 432402.6405, 83492.253, 432401.6719, 83480.5049, 432400.0471,
                                           83469.8335, 432398.5793, 83454.4708, 432396.5091, 83439.9015, 432394.3522,
                                           83430.1255, 432392.9077, 83413.6929, 432390.3107, 83402.2278, 432388.454,
                                           83392.6098, 432386.7446, 83379.4273, 432384.0751, 83369.9999, 432382.0366,
                                           83361.1464, 432380.0665, 83352.1562, 432378.0468, 83343.912, 432376.043,
                                           83335.4082, 432373.7248, 83325.469, 432370.9722, 83318.3576, 432368.8124,
                                           83311.8442, 432366.8202, 83303.6597, 432364.4124, 83295.012, 432361.8069,
                                           83288.4711, 432359.78, 83280.202, 432357.2668, 83266.1044, 432352.804,
                                           83255.2911, 432349.4769, 83243.6479, 432345.7157, 83225.8779, 432339.8341,
                                           83213.5017, 432335.6789, 83203.7609, 432332.2078, 83194.5777, 432328.9228,
                                           83169.9185, 432320.0353, 83158.667, 432315.8873, 83145.3071, 432311.0989,
                                           83142.0807, 432309.846, 83128.1368, 432304.405, 83124.0833, 432302.7376,
                                           83107.276, 432296.2239, 83086.1038, 432288.0017, 83068.9598, 432281.3094,
                                           83054.9629, 432275.8074, 83034.6189, 432267.7855, 83027.9973, 432265.2499,
                                           82960.5476, 432238.8452, 82941.5693, 432231.4467, 82907.6383, 432218.5268,
                                           82879.3048, 432209.9325, 82834.1582, 432226.5541, 82814.3517, 432219.4988,
                                           82773.0839, 432208.7663, 82720.0409, 432247.2439, 82674.5987, 432280.0034,
                                           82624.2287, 432316.0669, 82601.1648, 432332.5625, 82555.5212, 432365.4141,
                                           82534.6005, 432380.3418, 82521.7125, 432389.3923, 82507.2115, 432399.4251,
                                           82486.7794, 432412.5536, 82483.9655, 432414.2157, 82477.2457, 432417.9456,
                                           82473.9481, 432419.9616, 82471.0971, 432421.6448, 82445.3271, 432431.6688,
                                           82442.4851, 432433.1091, 82436.1644, 432435.3401, 82433.1705, 432435.9412,
                                           82429.625, 432436.531, 82422.4991, 432435.9196, 82419.2538, 432435.1251,
                                           82413.7689, 432433.9611, 82397.9539, 432427.4016, 82393.2189, 432423.2146 };

        testPolygon( 1, gtype, srid, elemInfo, ordinates );
    }
    
    @Test
    public void testPolygonUnknownRings()
                            throws Exception {
        int gtype = 2003;
        int srid = 90112;

        int[] elemInfo = new int[] { 1, 5, 4, 1, 2, 2, 5, 2, 1, 315, 2, 2, 319, 2, 1, 513, 3, 1 };
        double[] ordinates = new double[] { 82393.2189, 432423.2146, 82392.7854, 432416.1569, 82399.8431, 432415.7234,
                                           82412.3401, 432423.3519, 82416.0052, 432424.2142, 82421.5559, 432425.3934,
                                           82431.263, 432426.1248, 82445.0785, 432419.9118, 82453.937, 432417.0837,
                                           82463.293, 432414.6532, 82466.0049, 432413.0384, 82468.8305, 432411.3702,
                                           82472.3005, 432409.2533, 82479.0526, 432405.5055, 82481.6087, 432403.9937,
                                           82501.7327, 432391.0591, 82516.0075, 432381.1794, 82528.8381, 432372.169,
                                           82549.7045, 432357.2799, 82595.3413, 432324.4331, 82618.4103, 432307.9338,
                                           82668.7707, 432271.8773, 82714.1871, 432239.1364, 82783.5877, 432198.2748,
                                           82817.6858, 432210.0709, 82840.7293, 432216.6568, 82887.6614, 432200.5234,
                                           82911.1702, 432209.1713, 82945.1831, 432222.1225, 82964.1897, 432229.5321,
                                           83031.6253, 432255.9313, 83038.2641, 432258.4736, 83058.6287, 432266.5036,
                                           83072.6127, 432272.0004, 83089.7361, 432278.6847, 83110.8944, 432286.9015,
                                           83127.8402, 432293.47, 83131.8989, 432295.1396, 83145.7116, 432300.5285,
                                           83148.8655, 432301.7532, 83162.1045, 432306.4967, 83173.3604, 432310.6464,
                                           83197.9627, 432319.5132, 83207.1262, 432322.7911, 83216.8149, 432326.2436,
                                           83229.0501, 432330.3506, 83246.773, 432336.2166, 83258.3316, 432339.9503,
                                           83269.103, 432343.2642, 83283.1924, 432347.7244, 83291.418, 432350.2241,
                                           83297.9532, 432352.2492, 83306.5287, 432354.8328, 83314.7434, 432357.2496,
                                           83321.2777, 432359.2482, 83328.3156, 432361.3857, 83338.0664, 432364.0846,
                                           83346.4746, 432366.3767, 83354.4738, 432368.319, 83363.3328, 432370.3084,
                                           83372.1574, 432372.2721, 83381.5085, 432374.294, 83394.5354, 432376.9315,
                                           83403.9387, 432378.6014, 83415.2818, 432380.4378, 83431.6616, 432383.0264,
                                           83441.3652, 432384.4599, 83455.903, 432386.6121, 83471.1893, 432388.6716,
                                           83481.873, 432390.1411, 83493.6203, 432391.7658, 83500.6957, 432392.7366,
                                           83534.273, 432397.4545, 83571.7144, 432402.704, 83609.7171, 432407.9885,
                                           83629.5556, 432410.8307, 83671.2182, 432416.7046, 83712.5769, 432422.4875,
                                           83736.1375, 432425.828, 83753.3268, 432428.1424, 83829.1696, 432438.7695,
                                           83861.467, 432443.3934, 83898.4829, 432448.5771, 83945.4923, 432454.8605,
                                           83957.6569, 432456.6966, 83960.6081, 432457.1781, 83965.3061, 432458.0507,
                                           83971.2053, 432459.1142, 83980.5972, 432460.85, 83986.2168, 432461.9921,
                                           83990.6029, 432462.9585, 83996.223, 432464.1693, 84001.1526, 432465.3536,
                                           84006.7655, 432466.6647, 84019.8716, 432469.7578, 84044.4455, 432475.1557,
                                           84052.7288, 432477.4576, 84057.7979, 432478.9095, 84060.3328, 432479.4056,
                                           84069.7121, 432481.2311, 84072.7868, 432481.717, 84089.9228, 432484.4132,
                                           84095.6646, 432485.3783, 84106.7913, 432487.2216, 84114.4722, 432488.7113,
                                           84126.2788, 432490.8676, 84140.8888, 432493.6316, 84144.1992, 432494.3065,
                                           84147.772, 432495.1025, 84157.7207, 432497.7803, 84163.1885, 432499.1761,
                                           84178.4783, 432511.8593, 84177.5753, 432515.3113, 84171.7424, 432537.3317,
                                           84169.2593, 432546.8902, 84152.6487, 432562.5918, 84140.8763, 432560.2479,
                                           84129.0978, 432557.906, 84125.8873, 432557.281, 84117.3204, 432555.5964,
                                           84111.1917, 432554.4227, 84102.8876, 432553.0493, 84098.0539, 432579.2946,
                                           84088.5707, 432605.5144, 84077.1611, 432675.3089, 84074.4949, 432691.5724,
                                           84067.0782, 432736.0515, 84057.4224, 432793.2374, 84053.3248, 432817.5713,
                                           84046.217, 432858.6585, 84033.4529, 432933.6782, 84030.0201, 432954.0755,
                                           84023.3673, 432992.3382, 84018.4345, 433022.01, 84012.9065, 433053.9,
                                           84007.742, 433084.9643, 83999.5319, 433133.1785, 83995.0635, 433159.7365,
                                           83987.3993, 433205.2379, 83985.4684, 433216.6816, 83982.4817, 433234.2591,
                                           83978.5204, 433257.1358, 83973.9678, 433283.3718, 83964.9956, 433336.8815,
                                           83958.4786, 433376.5744, 83951.6201, 433417.6021, 83945.6518, 433453.5977,
                                           83939.1526, 433492.9064, 83934.8164, 433519.3445, 83929.2923, 433552.8449,
                                           83923.1682, 433589.9645, 83916.476, 433631.0894, 83904.9437, 433681.0462,
                                           83901.9415, 433684.6096, 83898.5524, 433687.5776, 83874.7209, 433704.1055,
                                           83868.1428, 433708.6889, 83865.9354, 433721.5047, 83860.197, 433725.5898,
                                           83856.0682, 433719.8827, 84048.9233, 432486.8368, 84017.5785, 432479.4913,
                                           84004.4741, 432476.3986, 83998.832, 432475.0807, 83993.9449, 432473.9066,
                                           83988.4632, 432472.7269, 83984.1054, 432471.7668, 83978.6502, 432470.6588,
                                           83969.3993, 432468.9498, 83963.4929, 432467.8849, 83958.8368, 432467.0201,
                                           83951.4884, 432465.7884, 83944.1301, 432464.7673, 83897.1116, 432458.4827,
                                           83860.0574, 432453.2935, 83827.7598, 432448.6696, 83751.9525, 432438.0475,
                                           83734.7511, 432435.7315, 83711.1779, 432432.3892, 83669.825, 432426.607,
                                           83628.1429, 432420.7305, 83608.3091, 432417.8889, 83570.3288, 432412.6076,
                                           83532.8823, 432407.3574, 83499.3123, 432402.6405, 83492.253, 432401.6719,
                                           83480.5049, 432400.0471, 83469.8335, 432398.5793, 83454.4708, 432396.5091,
                                           83439.9015, 432394.3522, 83430.1255, 432392.9077, 83413.6929, 432390.3107,
                                           83402.2278, 432388.454, 83392.6098, 432386.7446, 83379.4273, 432384.0751,
                                           83369.9999, 432382.0366, 83361.1464, 432380.0665, 83352.1562, 432378.0468,
                                           83343.912, 432376.043, 83335.4082, 432373.7248, 83325.469, 432370.9722,
                                           83318.3576, 432368.8124, 83311.8442, 432366.8202, 83303.6597, 432364.4124,
                                           83295.012, 432361.8069, 83288.4711, 432359.78, 83280.202, 432357.2668,
                                           83266.1044, 432352.804, 83255.2911, 432349.4769, 83243.6479, 432345.7157,
                                           83225.8779, 432339.8341, 83213.5017, 432335.6789, 83203.7609, 432332.2078,
                                           83194.5777, 432328.9228, 83169.9185, 432320.0353, 83158.667, 432315.8873,
                                           83145.3071, 432311.0989, 83142.0807, 432309.846, 83128.1368, 432304.405,
                                           83124.0833, 432302.7376, 83107.276, 432296.2239, 83086.1038, 432288.0017,
                                           83068.9598, 432281.3094, 83054.9629, 432275.8074, 83034.6189, 432267.7855,
                                           83027.9973, 432265.2499, 82960.5476, 432238.8452, 82941.5693, 432231.4467,
                                           82907.6383, 432218.5268, 82879.3048, 432209.9325, 82834.1582, 432226.5541,
                                           82814.3517, 432219.4988, 82773.0839, 432208.7663, 82720.0409, 432247.2439,
                                           82674.5987, 432280.0034, 82624.2287, 432316.0669, 82601.1648, 432332.5625,
                                           82555.5212, 432365.4141, 82534.6005, 432380.3418, 82521.7125, 432389.3923,
                                           82507.2115, 432399.4251, 82486.7794, 432412.5536, 82483.9655, 432414.2157,
                                           82477.2457, 432417.9456, 82473.9481, 432419.9616, 82471.0971, 432421.6448,
                                           82445.3271, 432431.6688, 82442.4851, 432433.1091, 82436.1644, 432435.3401,
                                           82433.1705, 432435.9412, 82429.625, 432436.531, 82422.4991, 432435.9196,
                                           82419.2538, 432435.1251, 82413.7689, 432433.9611, 82397.9539, 432427.4016,
                                           82393.2189, 432423.2146, 84058.8188, 432489.2986, 83870.0584, 433695.1695,
                                           83900.0704, 433667.8566, 83906.6149, 433629.4287, 83913.3007, 433588.3421,
                                           83919.4257, 433551.2173, 83924.9493, 433517.7196, 83929.286, 433491.2784,
                                           83935.7863, 433451.9631, 83941.7564, 433415.9566, 83948.6142, 433374.9328,
                                           83955.1318, 433335.2362, 83964.1126, 433281.6762, 83968.6675, 433255.427,
                                           83972.627, 433232.5607, 83975.6092, 433215.0093, 83977.5386, 433203.5748,
                                           83985.2024, 433158.076, 83989.673, 433131.5047, 83997.8823, 433083.2953,
                                           84003.0505, 433052.209, 84008.5785, 433020.319, 84013.5119, 432990.6435,
                                           84020.1656, 432952.3758, 84023.5938, 432932.0053, 84036.3622, 432856.9607,
                                           84043.4693, 432815.8777, 84047.5618, 432791.5735, 84057.2169, 432734.3916,
                                           84064.63, 432689.9344, 84067.2927, 432673.6922, 84079.0091, 432602.5494,
                                           84088.5073, 432576.2882, 84103.6289, 432543.036, 84113.0105, 432544.5893,
                                           84119.2377, 432545.782, 84127.812, 432547.468, 84131.0381, 432548.096,
                                           84142.8283, 432550.4402, 84157.4833, 432552.3942, 84159.5837, 432544.3638,
                                           84162.0727, 432534.7827, 84166.3463, 432510.2053, 84160.7553, 432508.8757,
                                           84148.1332, 432505.5377, 84145.3225, 432504.7983, 84142.0769, 432504.0788,
                                           84135.1982, 432502.7264, 84124.4395, 432500.697, 84112.595, 432498.5335,
                                           84098.2177, 432495.9074, 84094.0302, 432495.2438, 84088.2911, 432494.2792,
                                           84071.2275, 432491.5947, 84067.8887, 432491.0639, 84058.8188, 432489.2986 };

        testPolygon( 1, gtype, srid, elemInfo, ordinates );
    }

    @Test
    public void testPolygonCompoundExteriorSimpleInterior()
                            throws Exception {
        int gtype = 2003;
        int srid = 90112;

        int[] elemInfo = new int[] { 1, 1005, 4, 1, 2, 2, 5, 2, 1, 315, 2, 2, 319, 2, 1, 513, 2003, 1 };
        double[] ordinates = new double[] { 82393.2189, 432423.2146, 82392.7854, 432416.1569, 82399.8431, 432415.7234,
                                           82412.3401, 432423.3519, 82416.0052, 432424.2142, 82421.5559, 432425.3934,
                                           82431.263, 432426.1248, 82445.0785, 432419.9118, 82453.937, 432417.0837,
                                           82463.293, 432414.6532, 82466.0049, 432413.0384, 82468.8305, 432411.3702,
                                           82472.3005, 432409.2533, 82479.0526, 432405.5055, 82481.6087, 432403.9937,
                                           82501.7327, 432391.0591, 82516.0075, 432381.1794, 82528.8381, 432372.169,
                                           82549.7045, 432357.2799, 82595.3413, 432324.4331, 82618.4103, 432307.9338,
                                           82668.7707, 432271.8773, 82714.1871, 432239.1364, 82783.5877, 432198.2748,
                                           82817.6858, 432210.0709, 82840.7293, 432216.6568, 82887.6614, 432200.5234,
                                           82911.1702, 432209.1713, 82945.1831, 432222.1225, 82964.1897, 432229.5321,
                                           83031.6253, 432255.9313, 83038.2641, 432258.4736, 83058.6287, 432266.5036,
                                           83072.6127, 432272.0004, 83089.7361, 432278.6847, 83110.8944, 432286.9015,
                                           83127.8402, 432293.47, 83131.8989, 432295.1396, 83145.7116, 432300.5285,
                                           83148.8655, 432301.7532, 83162.1045, 432306.4967, 83173.3604, 432310.6464,
                                           83197.9627, 432319.5132, 83207.1262, 432322.7911, 83216.8149, 432326.2436,
                                           83229.0501, 432330.3506, 83246.773, 432336.2166, 83258.3316, 432339.9503,
                                           83269.103, 432343.2642, 83283.1924, 432347.7244, 83291.418, 432350.2241,
                                           83297.9532, 432352.2492, 83306.5287, 432354.8328, 83314.7434, 432357.2496,
                                           83321.2777, 432359.2482, 83328.3156, 432361.3857, 83338.0664, 432364.0846,
                                           83346.4746, 432366.3767, 83354.4738, 432368.319, 83363.3328, 432370.3084,
                                           83372.1574, 432372.2721, 83381.5085, 432374.294, 83394.5354, 432376.9315,
                                           83403.9387, 432378.6014, 83415.2818, 432380.4378, 83431.6616, 432383.0264,
                                           83441.3652, 432384.4599, 83455.903, 432386.6121, 83471.1893, 432388.6716,
                                           83481.873, 432390.1411, 83493.6203, 432391.7658, 83500.6957, 432392.7366,
                                           83534.273, 432397.4545, 83571.7144, 432402.704, 83609.7171, 432407.9885,
                                           83629.5556, 432410.8307, 83671.2182, 432416.7046, 83712.5769, 432422.4875,
                                           83736.1375, 432425.828, 83753.3268, 432428.1424, 83829.1696, 432438.7695,
                                           83861.467, 432443.3934, 83898.4829, 432448.5771, 83945.4923, 432454.8605,
                                           83957.6569, 432456.6966, 83960.6081, 432457.1781, 83965.3061, 432458.0507,
                                           83971.2053, 432459.1142, 83980.5972, 432460.85, 83986.2168, 432461.9921,
                                           83990.6029, 432462.9585, 83996.223, 432464.1693, 84001.1526, 432465.3536,
                                           84006.7655, 432466.6647, 84019.8716, 432469.7578, 84044.4455, 432475.1557,
                                           84052.7288, 432477.4576, 84057.7979, 432478.9095, 84060.3328, 432479.4056,
                                           84069.7121, 432481.2311, 84072.7868, 432481.717, 84089.9228, 432484.4132,
                                           84095.6646, 432485.3783, 84106.7913, 432487.2216, 84114.4722, 432488.7113,
                                           84126.2788, 432490.8676, 84140.8888, 432493.6316, 84144.1992, 432494.3065,
                                           84147.772, 432495.1025, 84157.7207, 432497.7803, 84163.1885, 432499.1761,
                                           84178.4783, 432511.8593, 84177.5753, 432515.3113, 84171.7424, 432537.3317,
                                           84169.2593, 432546.8902, 84152.6487, 432562.5918, 84140.8763, 432560.2479,
                                           84129.0978, 432557.906, 84125.8873, 432557.281, 84117.3204, 432555.5964,
                                           84111.1917, 432554.4227, 84102.8876, 432553.0493, 84098.0539, 432579.2946,
                                           84088.5707, 432605.5144, 84077.1611, 432675.3089, 84074.4949, 432691.5724,
                                           84067.0782, 432736.0515, 84057.4224, 432793.2374, 84053.3248, 432817.5713,
                                           84046.217, 432858.6585, 84033.4529, 432933.6782, 84030.0201, 432954.0755,
                                           84023.3673, 432992.3382, 84018.4345, 433022.01, 84012.9065, 433053.9,
                                           84007.742, 433084.9643, 83999.5319, 433133.1785, 83995.0635, 433159.7365,
                                           83987.3993, 433205.2379, 83985.4684, 433216.6816, 83982.4817, 433234.2591,
                                           83978.5204, 433257.1358, 83973.9678, 433283.3718, 83964.9956, 433336.8815,
                                           83958.4786, 433376.5744, 83951.6201, 433417.6021, 83945.6518, 433453.5977,
                                           83939.1526, 433492.9064, 83934.8164, 433519.3445, 83929.2923, 433552.8449,
                                           83923.1682, 433589.9645, 83916.476, 433631.0894, 83904.9437, 433681.0462,
                                           83901.9415, 433684.6096, 83898.5524, 433687.5776, 83874.7209, 433704.1055,
                                           83868.1428, 433708.6889, 83865.9354, 433721.5047, 83860.197, 433725.5898,
                                           83856.0682, 433719.8827, 84048.9233, 432486.8368, 84017.5785, 432479.4913,
                                           84004.4741, 432476.3986, 83998.832, 432475.0807, 83993.9449, 432473.9066,
                                           83988.4632, 432472.7269, 83984.1054, 432471.7668, 83978.6502, 432470.6588,
                                           83969.3993, 432468.9498, 83963.4929, 432467.8849, 83958.8368, 432467.0201,
                                           83951.4884, 432465.7884, 83944.1301, 432464.7673, 83897.1116, 432458.4827,
                                           83860.0574, 432453.2935, 83827.7598, 432448.6696, 83751.9525, 432438.0475,
                                           83734.7511, 432435.7315, 83711.1779, 432432.3892, 83669.825, 432426.607,
                                           83628.1429, 432420.7305, 83608.3091, 432417.8889, 83570.3288, 432412.6076,
                                           83532.8823, 432407.3574, 83499.3123, 432402.6405, 83492.253, 432401.6719,
                                           83480.5049, 432400.0471, 83469.8335, 432398.5793, 83454.4708, 432396.5091,
                                           83439.9015, 432394.3522, 83430.1255, 432392.9077, 83413.6929, 432390.3107,
                                           83402.2278, 432388.454, 83392.6098, 432386.7446, 83379.4273, 432384.0751,
                                           83369.9999, 432382.0366, 83361.1464, 432380.0665, 83352.1562, 432378.0468,
                                           83343.912, 432376.043, 83335.4082, 432373.7248, 83325.469, 432370.9722,
                                           83318.3576, 432368.8124, 83311.8442, 432366.8202, 83303.6597, 432364.4124,
                                           83295.012, 432361.8069, 83288.4711, 432359.78, 83280.202, 432357.2668,
                                           83266.1044, 432352.804, 83255.2911, 432349.4769, 83243.6479, 432345.7157,
                                           83225.8779, 432339.8341, 83213.5017, 432335.6789, 83203.7609, 432332.2078,
                                           83194.5777, 432328.9228, 83169.9185, 432320.0353, 83158.667, 432315.8873,
                                           83145.3071, 432311.0989, 83142.0807, 432309.846, 83128.1368, 432304.405,
                                           83124.0833, 432302.7376, 83107.276, 432296.2239, 83086.1038, 432288.0017,
                                           83068.9598, 432281.3094, 83054.9629, 432275.8074, 83034.6189, 432267.7855,
                                           83027.9973, 432265.2499, 82960.5476, 432238.8452, 82941.5693, 432231.4467,
                                           82907.6383, 432218.5268, 82879.3048, 432209.9325, 82834.1582, 432226.5541,
                                           82814.3517, 432219.4988, 82773.0839, 432208.7663, 82720.0409, 432247.2439,
                                           82674.5987, 432280.0034, 82624.2287, 432316.0669, 82601.1648, 432332.5625,
                                           82555.5212, 432365.4141, 82534.6005, 432380.3418, 82521.7125, 432389.3923,
                                           82507.2115, 432399.4251, 82486.7794, 432412.5536, 82483.9655, 432414.2157,
                                           82477.2457, 432417.9456, 82473.9481, 432419.9616, 82471.0971, 432421.6448,
                                           82445.3271, 432431.6688, 82442.4851, 432433.1091, 82436.1644, 432435.3401,
                                           82433.1705, 432435.9412, 82429.625, 432436.531, 82422.4991, 432435.9196,
                                           82419.2538, 432435.1251, 82413.7689, 432433.9611, 82397.9539, 432427.4016,
                                           82393.2189, 432423.2146, 84058.8188, 432489.2986, 83870.0584, 433695.1695,
                                           83900.0704, 433667.8566, 83906.6149, 433629.4287, 83913.3007, 433588.3421,
                                           83919.4257, 433551.2173, 83924.9493, 433517.7196, 83929.286, 433491.2784,
                                           83935.7863, 433451.9631, 83941.7564, 433415.9566, 83948.6142, 433374.9328,
                                           83955.1318, 433335.2362, 83964.1126, 433281.6762, 83968.6675, 433255.427,
                                           83972.627, 433232.5607, 83975.6092, 433215.0093, 83977.5386, 433203.5748,
                                           83985.2024, 433158.076, 83989.673, 433131.5047, 83997.8823, 433083.2953,
                                           84003.0505, 433052.209, 84008.5785, 433020.319, 84013.5119, 432990.6435,
                                           84020.1656, 432952.3758, 84023.5938, 432932.0053, 84036.3622, 432856.9607,
                                           84043.4693, 432815.8777, 84047.5618, 432791.5735, 84057.2169, 432734.3916,
                                           84064.63, 432689.9344, 84067.2927, 432673.6922, 84079.0091, 432602.5494,
                                           84088.5073, 432576.2882, 84103.6289, 432543.036, 84113.0105, 432544.5893,
                                           84119.2377, 432545.782, 84127.812, 432547.468, 84131.0381, 432548.096,
                                           84142.8283, 432550.4402, 84157.4833, 432552.3942, 84159.5837, 432544.3638,
                                           84162.0727, 432534.7827, 84166.3463, 432510.2053, 84160.7553, 432508.8757,
                                           84148.1332, 432505.5377, 84145.3225, 432504.7983, 84142.0769, 432504.0788,
                                           84135.1982, 432502.7264, 84124.4395, 432500.697, 84112.595, 432498.5335,
                                           84098.2177, 432495.9074, 84094.0302, 432495.2438, 84088.2911, 432494.2792,
                                           84071.2275, 432491.5947, 84067.8887, 432491.0639, 84058.8188, 432489.2986 };

        testPolygon( 1, gtype, srid, elemInfo, ordinates );
    }

    private void testMultiPolygon( int expectedPolygons, int[] expectedInteriorRings, int gtype, int srid,
                                   int[] elemInfo, double[] ordinates )
                            throws SQLException {
        Geometry geometry = converter.toGeometry( new SDOGeometryConverter.GeomHolder( gtype, srid, null, elemInfo,
                                                                                       ordinates, null ), null );
        assertNotNull( "null geometry", geometry );
        assertTrue( "not a multi polygon", geometry instanceof MultiPolygon );

        int i = 0, ordinatesIdx = 0;
        MultiPolygon multiPolygon = (MultiPolygon) geometry;
        assertEquals( "wrong number of polygons", expectedPolygons, multiPolygon.size() );
        for ( Polygon polygon : multiPolygon ) {
            assertNotNull( "null polygon", polygon );

            ordinatesIdx = assertPolygon( expectedInteriorRings[i++], ordinates, polygon, ordinatesIdx );
        }
    }

    private void testPolygon( int expectedInteriorRings, int gtype, int srid, int[] elemInfo, double[] ordinates )
                            throws SQLException {
        Geometry geometry = converter.toGeometry( new SDOGeometryConverter.GeomHolder( gtype, srid, null, elemInfo,
                                                                                       ordinates, null ), null );
        assertNotNull( "null geometry", geometry );
        assertTrue( "not a polygon", geometry instanceof Polygon );
        Polygon polygon = (Polygon) geometry;

        assertPolygon( expectedInteriorRings, ordinates, polygon, 0 );
    }

    private int assertPolygon( int expectedInteriorRings, double[] ordinates, Polygon polygon, int ordinatesIdx ) {
        Ring exteriorRing = polygon.getExteriorRing();
        List<Ring> interiorRings = polygon.getInteriorRings();
        assertNotNull( "exteriorRing null", exteriorRing );
        assertNotNull( "interiorRings null", interiorRings );
        assertEquals( "wrong number of interiorRings", expectedInteriorRings, interiorRings.size() );

        ordinatesIdx = assertRing( ordinates, exteriorRing, ordinatesIdx );
        for ( Ring interiorRing : interiorRings ) {
            ordinatesIdx = assertRing( ordinates, interiorRing, ordinatesIdx );
        }

        return ordinatesIdx;
    }

    private int assertRing( double[] ordinates, Ring ring, int ordinatesIdx ) {
        List<CurveSegment> curveSegments = ring.getCurveSegments();
        assertNotNull( "curveSegments null", curveSegments );
        for ( CurveSegment curveSegment : curveSegments ) {
            assertNotNull( "curveSegment null", curveSegment );
            if ( curveSegment instanceof ArcString ) {
                ArcString arcString = (ArcString) curveSegment;

                Points points = arcString.getControlPoints();
                assertNotNull( "points null", points );

                for ( Point p : points ) {
                    assertNotNull( "point null", p );
                    assertEquals( "wrong coordinate", ordinates[ordinatesIdx++], p.get0(), 0.05 );
                    assertEquals( "wrong coordinate", ordinates[ordinatesIdx++], p.get1(), 0.05 );
                }

                ordinatesIdx -= 2;
            } else if ( curveSegment instanceof LineStringSegment ) {
                LineStringSegment lineStringSegment = (LineStringSegment) curveSegment;

                Points points = lineStringSegment.getControlPoints();
                assertNotNull( "points null", points );

                for ( Point p : points ) {
                    assertNotNull( "point null", p );
                    assertEquals( "wrong coordinate", ordinates[ordinatesIdx++], p.get0(), 0.05 );
                    assertEquals( "wrong coordinate", ordinates[ordinatesIdx++], p.get1(), 0.05 );
                }

                ordinatesIdx -= 2;
            } else {
                fail( "unknown curveSegment type" );
            }
        }

        return ordinatesIdx + 2;
    }

    @Test
    public void testOrientation() {
        final double[] exteriorRing = { 2, 4, 4, 3, 10, 3, 13, 5, 13, 9, 11, 13, 5, 13, 2, 11, 2, 4 };
        final double[] interiorRing = { 7, 5, 7, 10, 10, 10, 10, 5, 7, 5 };

        assertPoints( toPolygon( exteriorRing, interiorRing ), exteriorRing, interiorRing );
        assertPoints( toPolygon( reverseRing( exteriorRing ), reverseRing( interiorRing ) ), exteriorRing, interiorRing );
    }

    private double[] reverseRing( final double[] ring ) {
        final double[] reversedRing = new double[ring.length];

        final int hLength = reversedRing.length / 2;
        for ( int i = 0; i < hLength; i++ ) {
            final int ringI = hLength - i - 1;
            reversedRing[i * 2] = ring[ringI * 2];
            reversedRing[i * 2 + 1] = ring[ringI * 2 + 1];
        }

        return reversedRing;
    }

    private void assertPoints( final Polygon polygon, final double[] exteriorRing, final double[]... interiorRings ) {
        final ArrayList<Triplet> info = new ArrayList<Triplet>();
        final ArrayList<Point> pnts = new ArrayList<Point>();
        final SDOGeometryConverter converter = new SDOGeometryConverter();
        final int gtyp = converter.buildPrimitive( info, pnts, polygon );

        assertEquals( SDOGTypeTT.POLYGON, gtyp );
        int i = 0;
        for ( ; i < exteriorRing.length / 2; i++ ) {
            final Point point = pnts.get( i );
            assertEquals( "exterior[" + i + "].x invalid", exteriorRing[i * 2], point.get0(), 0.05 );
            assertEquals( "exterior[" + i + "].y invalid", exteriorRing[i * 2 + 1], point.get1(), 0.05 );
        }

        for ( int j = 0; j < interiorRings.length; j++ ) {
            int ringI = 0;
            final double[] interiorRing = interiorRings[j];

            final int next = i + interiorRing.length / 2;
            for ( ; i < next; i++ ) {
                final Point point = pnts.get( i );
                assertEquals( "interior[" + 0 + "][" + i + "].x invalid", interiorRing[ringI++], point.get0(), 0.05 );
                assertEquals( "interior[" + 0 + "][" + i + "].y invalid", interiorRing[ringI++], point.get1(), 0.05 );
            }
        }

        assertEquals( i, pnts.size() );
    }

    private Polygon toPolygon( final double[] exteriorRing, final double[]... interiorRings ) {
        ArrayList<Ring> rngs = new ArrayList<Ring>();
        for ( double[] interiorRing : interiorRings ) {
            rngs.add( toRing( interiorRing ) );
        }
        return geometryFactory.createPolygon( "polygon", null, toRing( exteriorRing ), rngs );
    }

    private Ring toRing( final double[] pnts ) {
        final ArrayList<Point> pointList = new ArrayList<Point>();
        for ( int i = 0; i < pnts.length; ) {
            pointList.add( geometryFactory.createPoint( "point" + ( i / 2 ), pnts[i++], pnts[i++], null ) );
        }
        final Points points = geometryFactory.createPoints( pointList );
        final Curve curve = geometryFactory.createLineString( "curve", null, points );
        final Ring ring = geometryFactory.createRing( "ring", null, Arrays.asList( curve ) );
        return ring;
    }
}
