<ui:composition template="/layout.xhtml" xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
  xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:c="http://java.sun.com/jsp/jstl/core" xmlns:fn="http://java.sun.com/jsp/jstl/functions"
  xmlns:dg="http://deegree.org/jsf" xmlns:dgc="http://java.sun.com/jsf/composite/deegree">
  <ui:define name="center">
    <h:panelGroup rendered="#{!logBean.loggedIn}">
      <ui:include src="/console/jsf/accessForbidden.xhtml" />
    </h:panelGroup>
    <h:panelGroup rendered="#{logBean.loggedIn}">
      <fieldset class="fieldset">
        <legend>
          <h:outputText styleClass="titel" value="jdbc" />
        </legend>
        <h:form>
          <table style="font-size: small" border="0">
            <tr>
              <td />
            </tr>
            <h:commandButton styleClass="buttonEdit" value="Use XML editor" action="#{jdbcBean.editAsXml}"></h:commandButton>
            <tr>
              <td />
            </tr>
            <tr>
              <td><h:outputText value="DB type: " /></td>
              <td><h:selectOneMenu styleClass="liste" value="#{jdbcBean.dbType}">
                  <f:selectItem itemValue="mssql" itemLabel="MSSQL" />
                  <f:selectItem itemValue="oracle" itemLabel="Oracle" />
                  <f:selectItem itemValue="postgis" itemLabel="PostGIS" />
                  <f:selectItem itemValue="geopackage" itemLabel="GeoPackage" />
                  <f:ajax render="fields dbConn dbPort" />
                </h:selectOneMenu></td>
            </tr>
          </table>
          <h:panelGroup id="fields">
            <table>
              <tr>
                <td><h:outputText value="Host: "
                    rendered="#{jdbcBean.dbType == 'mssql' or jdbcBean.dbType == 'oracle' or jdbcBean.dbType == 'postgis'}" /></td>
                <td><h:inputText id="dbHost" size="25" required="false" requiredMessage="#{labels.jdbc_edit_host_req}" value="#{jdbcBean.dbHost}"
                    rendered="#{jdbcBean.dbType == 'mssql' or jdbcBean.dbType == 'oracle' or jdbcBean.dbType == 'postgis'}">
                    <f:ajax render="dbConn" />
                  </h:inputText> <h:outputText value=" Port: " rendered="#{jdbcBean.dbType == 'mssql' or jdbcBean.dbType == 'oracle' or jdbcBean.dbType == 'postgis'}" />
                  <h:inputText id="dbPort" size="5" required="false" requiredMessage="#{labels.jdbc_edit_port_req}" value="#{jdbcBean.dbPort}"
                    rendered="#{jdbcBean.dbType == 'mssql' or jdbcBean.dbType == 'oracle' or jdbcBean.dbType == 'postgis'}">
                    <f:validateLongRange minimum="0" maximum="65535" />
                    <f:ajax render="dbConn" />
                  </h:inputText></td>
              </tr>
              <tr>
                <td><h:outputText value="DB name: "
                    rendered="#{jdbcBean.dbType == 'mssql' or jdbcBean.dbType == 'oracle' or jdbcBean.dbType == 'postgis'}" /> <h:outputText
                    value="Path to file: " rendered="#{jdbcBean.dbType == 'geopackage'}" /></td>
                <td><h:inputText id="dbName" size="25" required="true" requiredMessage="#{labels.jdbc_edit_dbname_req}" value="#{jdbcBean.dbName}">
                    <f:ajax render="dbConn" />
                  </h:inputText></td>
              </tr>
              <tr>
                <td><h:outputText value="Username: "
                    rendered="#{jdbcBean.dbType == 'mssql' or jdbcBean.dbType == 'oracle' or jdbcBean.dbType == 'postgis'}" /></td>
                <td><h:inputText id="dbUser" size="25" required="true" requiredMessage="#{labels.jdbc_edit_user_req}" value="#{jdbcBean.dbUser}"
                    rendered="#{jdbcBean.dbType == 'mssql' or jdbcBean.dbType == 'oracle' or jdbcBean.dbType == 'postgis'}">
                    <f:ajax render="dbConn" />
                  </h:inputText></td>
              </tr>
              <tr>
                <td><h:outputText value="Password: "
                    rendered="#{jdbcBean.dbType == 'mssql' or jdbcBean.dbType == 'oracle' or jdbcBean.dbType == 'postgis'}" /></td>
                <td><h:inputText id="dbPwd" size="10" value="#{jdbcBean.dbPwd}"
                    rendered="#{jdbcBean.dbType == 'mssql' or jdbcBean.dbType == 'oracle' or jdbcBean.dbType == 'postgis'}">
                    <f:ajax render="dbConn" />
                  </h:inputText></td>
              </tr>
              <tr>
                <td><h:outputText value="jdbc URL: " /></td>
                <td><h:inputText id="dbConn" size="50" required="true" requiredMessage="#{labels.jdbc_edit_conn_req}" redisplay="false"
                    value="#{jdbcBean.dbConn}" /></td>
              </tr>
              <tr>
                <td><br /> <h:commandButton styleClass="buttonInfo" value="#{labels.jdbc_test}" action="#{jdbcBean.testConnection}" alt="#{config.id}">
                  </h:commandButton></td>
              </tr>
            </table>
          </h:panelGroup>
          <br />
          <div>
            <h:commandButton styleClass="buttonCreateNew" value="Create" action="#{jdbcBean.save}">
              <f:setPropertyActionListener target="#{actionParams.param1}" value="#{config.id}" />
            </h:commandButton>
            <h:outputLink styleClass="buttonCancel" value="../../#{configManager.currentResourceManager.startView}.jsf" action="#{jdbcBean.cancel}">
              <h:outputText value="Cancel" />
            </h:outputLink>
          </div>
        </h:form>
      </fieldset>
    </h:panelGroup>
  </ui:define>
</ui:composition>