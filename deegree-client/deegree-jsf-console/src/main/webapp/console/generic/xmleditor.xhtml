<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html">

<f:metadata>
  <f:viewParam name="id" value="#{xmlEditorBean.id}" />
  <f:viewParam name="fileName" value="#{xmlEditorBean.fileName}" />
  <f:viewParam name="schemaUrl" value="#{xmlEditorBean.schemaUrl}" />
  <f:viewParam name="resourceManagerClass" value="#{xmlEditorBean.resourceManagerClass}" />
  <f:viewParam name="nextView" value="#{xmlEditorBean.nextView}" />
</f:metadata>

<h:body>
  <ui:composition template="/layout.xhtml" xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions" xmlns:dg="http://deegree.org/jsf"
    xmlns:dgc="http://java.sun.com/jsf/composite/deegree">
    <ui:define name="center">
      <script type="text/javascript" src="../js/CodeMirror-0.94/js/codemirror.js"></script>
      <script type="text/javascript">
    var editor
    function activateEditor(){
        editor = CodeMirror.fromTextArea("xmlForm:inputXML", {
          parserfile: "parsexml.js",
          path: "../js/CodeMirror-0.94/js/",
          stylesheet: "../js/CodeMirror-0.94/css/xmlcolors.css"
        })
        var p = document.getElementById("highlighting")
        p.parentNode.removeChild(p)
    }
    function save(){
        editor &amp;&amp; editor.toTextArea()
    }
  </script>
      <h:panelGroup>
        <br />
        <div>
          Editing: <br /> #{xmlEditorBean.fileName}
          <h:panelGroup rendered="#{xmlEditorBean.schemaUrl != null}">
            <fieldset class="fieldset">
              <legend>
                <h:outputText styleClass="titel" value="#{xmlEditorBean.fileName}" />
              </legend>
              <h:form id="xmlForm">
                <h:panelGroup>
                  <h:link styleClass="schema" value="#{labels.xmlEditor_schema}" outcome="schema" target="_blank">
                    <f:param name="fileName" value="#{xmlEditorBean.fileName}" />
                    <f:param name="schemaUrl" value="#{xmlEditorBean.schemaUrl}" />
                  </h:link>
                  <h:commandButton styleClass="buttonSave" value="#{labels.xmlEditor_save}" onclick="save()"
                    action="${xmlEditorBean.save}" />
                  <h:commandButton styleClass="buttonCancel" value="#{labels.xmlEditor_cancel}"
                    action="${xmlEditorBean.cancel}" />
                </h:panelGroup>
                <div style="border: 1px solid gray;">
                  <dg:inputConfigurationXML style="border: none;" id="inputXML" value="${xmlEditorBean.content}"
                    schemaURLS="${xmlEditorBean.schemaUrl}" cols="64" rows="20" />
                </div>
              </h:form>
              <p id="highlighting" style="cursor: pointer;" class="schema" onclick="activateEditor();">Turn on
                highlighting</p>
            </fieldset>
          </h:panelGroup>
        </div>
      </h:panelGroup>
    </ui:define>
  </ui:composition>
</h:body>
</html>
